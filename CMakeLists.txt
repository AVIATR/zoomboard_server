# Set up super-project
cmake_minimum_required(VERSION 3.5.0)
SET(MACOSX_DEPLOYMENT_TARGET ${DARWIN_MAJOR_SDK_VERSION}.${DARWIN_MINOR_SDK_VERSION})
SET(CMAKE_CXX_FLAGS "--sysroot ${CMAKE_OSX_SYSROOT} ${CMAKE_CXX_FLAGS}")
MESSAGE("Setting MACOSX_DEPLOYMENT_TARGET to '${MACOSX_DEPLOYMENT_TARGET}'.")
#set(CMAKE_OSX_DEPLOYMENT_TARGET "")
#set(MACOSX_DEPLOYMENT_TARGET "")
#set(CMAKE_OSX_SYSROOT "")
#SET(CMAKE_CXX_FLAGS "--sysroot ${CMAKE_OSX_SYSROOT} ${CMAKE_CXX_FLAGS}")
#MESSAGE("Setting MACOSX_DEPLOYMENT_TARGET to '${MACOSX_DEPLOYMENT_TARGET}'.")
project(rtmp_server 
	LANGUAGES CXX
	VERSION 0.1.0)

set(CMAKE_MODULE_PATH "${CMAKE_SOURCE_DIR}/cmake_modules" ${CMAKE_MODULE_PATH})
#set(CMAKE_OSX_ARCHITECTURES "x86_64;i386")
set( CMAKE_VERBOSE_MAKEFILE on )	#uncomment for make script debugging purposes
message(STATUS "Module path set to: ${CMAKE_MODULE_PATH}")

#Add source folder
add_subdirectory("src")

# CPack packaging
include(InstallRequiredSystemLibraries)
set(CPACK_RESOURCE_FILE_LICENSE "${CMAKE_SOURCE_DIR}/COPYING")
set(CPACK_PACKAGE_VERSION_MAJOR "${PROJECT_VERSION_MAJOR}")
set(CPACK_PACKAGE_VERSION_MINOR "${PROJECT_VERSION_MINOR}")
include(CPack)
